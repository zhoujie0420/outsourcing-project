{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_Source = _resolveComponent(\"Source\");\n  const _component_EditorDemo = _resolveComponent(\"EditorDemo\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_el_row, null, {\n    default: _withCtx(() => [_createVNode(_component_el_col, {\n      span: 2,\n      style: {\n        \"vertical-align\": \"center\"\n      }\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"服务器地址：\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 10\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $data.serverUrl,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.serverUrl = $event)\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 1\n    }), _createVNode(_component_el_col, {\n      span: 2\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        plain: \"\",\n        type: \"primary\",\n        onClick: $options.saveHtml\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"保存文档\")]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 2\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        plain: \"\",\n        type: \"primary\",\n        onClick: $options.saveHtmlAndData\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"保存数据&文档\")]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }), _createVNode(_component_Source, {\n    src: \"/code/SaveDoc.vue\"\n  }), _createVNode(_component_EditorDemo, {\n    onAfterInit: $options.onAfterInit,\n    doc: \"https://www.x-emr.cn/doc/999.html\",\n    style: {\n      \"margin\": \"10px 0\"\n    }\n  }, null, 8 /* PROPS */, [\"onAfterInit\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_createVNode","_component_el_row","_component_el_col","span","style","_component_el_input","$data","serverUrl","$event","_component_el_button","plain","type","onClick","$options","saveHtml","saveHtmlAndData","_component_Source","src","_component_EditorDemo","onAfterInit","doc"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/zj/Front/src/views/SaveDoc.vue"],"sourcesContent":["\n<template>\n    <el-row>\n        <el-col :span=\"2\" style=\"vertical-align: center;\">服务器地址：</el-col>\n        <el-col :span=\"10\"><el-input v-model=\"serverUrl\" ></el-input></el-col>\n        <el-col :span=\"1\"></el-col>\n        <el-col :span=\"2\"><el-button plain type=\"primary\" @click=\"saveHtml\">保存文档</el-button></el-col>\n        <el-col :span=\"2\"> <el-button plain type=\"primary\" @click=\"saveHtmlAndData\">保存数据&文档</el-button></el-col>\n    </el-row>\n    <Source src=\"/code/SaveDoc.vue\"></Source>\n    <EditorDemo @AfterInit=\"onAfterInit\" doc=\"https://www.x-emr.cn/doc/999.html\" style=\"margin: 10px 0;\"></EditorDemo>\n\n</template>\n    \n<script>\n    import axios from 'axios'\n    import EditorDemo from \"@/components/EditorDemo.vue\";\n\n    export default{\n      components: {EditorDemo},\n        data(){\n            return{\n                editor:null,\n                 //服务端地址\n                serverUrl:'http://localhost/post'\n            }\n        },\n        methods:{\n            //初始化前\n            onAfterInit: function(e) {\n                this.editor = e.editor\n            },\n            //仅保存HTML文档\n            saveHtml: function() {\n                let data = {'doc': this.editor.getHtml()}\n                axios.post(this.serverUrl, data).then(res=>{\n                    console.log('res=>',res)\n                })\n            },\n            //保存文档及机构化数据\n            saveHtmlAndData: function() {\n                let data = {\n                    'doc': this.editor.getHtml(),\n                    'data': this.editor.getBindObject()\n                }\n              // 将 HTML 转换为 .doc 文件\n              let docx = htmlDocx.asBlob(data.doc);\n\n              // 创建一个下载链接\n              let url = window.URL.createObjectURL(docx);\n\n              // 创建一个 <a> 元素\n              let a = document.createElement('a');\n\n              // 设置下载链接\n              a.href = url;\n\n              // 设置文件名\n              a.download = 'document.docx';\n\n              // 模拟点击下载\n              a.click();\n\n              // 释放资源\n              window.URL.revokeObjectURL(url);\n            },\n        }\n\n}\n</script>"],"mappings":";;;;;;;;6DAEIA,YAAA,CAMSC,iBAAA;sBALL,MAAiE,CAAjED,YAAA,CAAiEE,iBAAA;MAAxDC,IAAI,EAAE,CAAC;MAAEC,KAA+B,EAA/B;QAAA;MAAA;;wBAAgC,MAAM,C,iBAAN,QAAM,E;;QACxDJ,YAAA,CAAsEE,iBAAA;MAA7DC,IAAI,EAAE;IAAE;wBAAE,MAA0C,CAA1CH,YAAA,CAA0CK,mBAAA;oBAAvBC,KAAA,CAAAC,SAAS;mEAATD,KAAA,CAAAC,SAAS,GAAAC,MAAA;;;QAC/CR,YAAA,CAA2BE,iBAAA;MAAlBC,IAAI,EAAE;IAAC,IAChBH,YAAA,CAA6FE,iBAAA;MAApFC,IAAI,EAAE;IAAC;wBAAE,MAAkE,CAAlEH,YAAA,CAAkES,oBAAA;QAAvDC,KAAK,EAAL,EAAK;QAACC,IAAI,EAAC,SAAS;QAAEC,OAAK,EAAEC,QAAA,CAAAC;;0BAAU,MAAI,C,iBAAJ,MAAI,E;;;;QACxEd,YAAA,CAAwGE,iBAAA;MAA/FC,IAAI,EAAE;IAAC;wBAAG,MAA4E,CAA5EH,YAAA,CAA4ES,oBAAA;QAAjEC,KAAK,EAAL,EAAK;QAACC,IAAI,EAAC,SAAS;QAAEC,OAAK,EAAEC,QAAA,CAAAE;;0BAAiB,MAAO,C,iBAAP,SAAO,E;;;;;;;MAEvFf,YAAA,CAAyCgB,iBAAA;IAAjCC,GAAG,EAAC;EAAmB,IAC/BjB,YAAA,CAAkHkB,qBAAA;IAArGC,WAAS,EAAEN,QAAA,CAAAM,WAAW;IAAEC,GAAG,EAAC,mCAAmC;IAAChB,KAAuB,EAAvB;MAAA;IAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}