{"ast":null,"code":"import axios from 'axios';\nimport EditorDemo from \"@/components/EditorDemo.vue\";\nimport htmlDocx from 'html-docx-js';\nexport default {\n  components: {\n    EditorDemo\n  },\n  data() {\n    return {\n      editor: null,\n      //服务端地址\n      serverUrl: 'http://localhost/post'\n    };\n  },\n  methods: {\n    //初始化前\n    onAfterInit: function (e) {\n      this.editor = e.editor;\n    },\n    //仅保存HTML文档\n    saveHtml: function () {\n      let data = {\n        'doc': this.editor.getHtml()\n      };\n      axios.post(this.serverUrl, data).then(res => {\n        console.log('res=>', res);\n      });\n    },\n    //保存文档及机构化数据\n    saveHtmlAndData: function () {\n      let data = {\n        'doc': this.editor.getHtml(),\n        'data': this.editor.getBindObject()\n      };\n      // 将 HTML 转换为 .doc 文件\n      let docx = htmlDocx.asBlob(data.doc);\n\n      // 创建一个下载链接\n      let url = window.URL.createObjectURL(docx);\n\n      // 创建一个 <a> 元素\n      let a = document.createElement('a');\n\n      // 设置下载链接\n      a.href = url;\n\n      // 设置文件名\n      a.download = 'document.docx';\n\n      // 模拟点击下载\n      a.click();\n\n      // 释放资源\n      window.URL.revokeObjectURL(url);\n    }\n  }\n};","map":{"version":3,"names":["axios","EditorDemo","htmlDocx","components","data","editor","serverUrl","methods","onAfterInit","e","saveHtml","getHtml","post","then","res","console","log","saveHtmlAndData","getBindObject","docx","asBlob","doc","url","window","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/zj/Front/src/views/SaveDoc.vue"],"sourcesContent":["\n<template>\n    <el-row>\n        <el-col :span=\"2\" style=\"vertical-align: center;\">服务器地址：</el-col>\n        <el-col :span=\"10\"><el-input v-model=\"serverUrl\" ></el-input></el-col>\n        <el-col :span=\"1\"></el-col>\n        <el-col :span=\"2\"><el-button plain type=\"primary\" @click=\"saveHtml\">保存文档</el-button></el-col>\n        <el-col :span=\"2\"> <el-button plain type=\"primary\" @click=\"saveHtmlAndData\">保存数据&文档</el-button></el-col>\n    </el-row>\n    <Source src=\"/code/SaveDoc.vue\"></Source>\n    <EditorDemo @AfterInit=\"onAfterInit\" doc=\"https://www.x-emr.cn/doc/999.html\" style=\"margin: 10px 0;\"></EditorDemo>\n\n</template>\n    \n<script>\n    import axios from 'axios'\n    import EditorDemo from \"@/components/EditorDemo.vue\";\n    import htmlDocx from 'html-docx-js';\n\n    export default{\n      components: {EditorDemo},\n        data(){\n            return{\n                editor:null,\n                 //服务端地址\n                serverUrl:'http://localhost/post'\n            }\n        },\n        methods:{\n            //初始化前\n            onAfterInit: function(e) {\n                this.editor = e.editor\n            },\n            //仅保存HTML文档\n            saveHtml: function() {\n                let data = {'doc': this.editor.getHtml()}\n                axios.post(this.serverUrl, data).then(res=>{\n                    console.log('res=>',res)\n                })\n            },\n            //保存文档及机构化数据\n            saveHtmlAndData: function() {\n                let data = {\n                    'doc': this.editor.getHtml(),\n                    'data': this.editor.getBindObject()\n                }\n              // 将 HTML 转换为 .doc 文件\n              let docx = htmlDocx.asBlob(data.doc);\n\n              // 创建一个下载链接\n              let url = window.URL.createObjectURL(docx);\n\n              // 创建一个 <a> 元素\n              let a = document.createElement('a');\n\n              // 设置下载链接\n              a.href = url;\n\n              // 设置文件名\n              a.download = 'document.docx';\n\n              // 模拟点击下载\n              a.click();\n\n              // 释放资源\n              window.URL.revokeObjectURL(url);\n            },\n        }\n\n}\n</script>"],"mappings":"AAeI,OAAOA,KAAI,MAAO,OAAM;AACxB,OAAOC,UAAS,MAAO,6BAA6B;AACpD,OAAOC,QAAO,MAAO,cAAc;AAEnC,eAAc;EACZC,UAAU,EAAE;IAACF;EAAU,CAAC;EACtBG,IAAIA,CAAA,EAAE;IACF,OAAM;MACFC,MAAM,EAAC,IAAI;MACV;MACDC,SAAS,EAAC;IACd;EACJ,CAAC;EACDC,OAAO,EAAC;IACJ;IACAC,WAAW,EAAE,SAAAA,CAASC,CAAC,EAAE;MACrB,IAAI,CAACJ,MAAK,GAAII,CAAC,CAACJ,MAAK;IACzB,CAAC;IACD;IACAK,QAAQ,EAAE,SAAAA,CAAA,EAAW;MACjB,IAAIN,IAAG,GAAI;QAAC,KAAK,EAAE,IAAI,CAACC,MAAM,CAACM,OAAO,CAAC;MAAC;MACxCX,KAAK,CAACY,IAAI,CAAC,IAAI,CAACN,SAAS,EAAEF,IAAI,CAAC,CAACS,IAAI,CAACC,GAAG,IAAE;QACvCC,OAAO,CAACC,GAAG,CAAC,OAAO,EAACF,GAAG;MAC3B,CAAC;IACL,CAAC;IACD;IACAG,eAAe,EAAE,SAAAA,CAAA,EAAW;MACxB,IAAIb,IAAG,GAAI;QACP,KAAK,EAAE,IAAI,CAACC,MAAM,CAACM,OAAO,CAAC,CAAC;QAC5B,MAAM,EAAE,IAAI,CAACN,MAAM,CAACa,aAAa,CAAC;MACtC;MACF;MACA,IAAIC,IAAG,GAAIjB,QAAQ,CAACkB,MAAM,CAAChB,IAAI,CAACiB,GAAG,CAAC;;MAEpC;MACA,IAAIC,GAAE,GAAIC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;;MAE1C;MACA,IAAIO,CAAA,GAAIC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;;MAEnC;MACAF,CAAC,CAACG,IAAG,GAAIP,GAAG;;MAEZ;MACAI,CAAC,CAACI,QAAO,GAAI,eAAe;;MAE5B;MACAJ,CAAC,CAACK,KAAK,CAAC,CAAC;;MAET;MACAR,MAAM,CAACC,GAAG,CAACQ,eAAe,CAACV,GAAG,CAAC;IACjC;EACJ;AAER"},"metadata":{},"sourceType":"module","externalDependencies":[]}