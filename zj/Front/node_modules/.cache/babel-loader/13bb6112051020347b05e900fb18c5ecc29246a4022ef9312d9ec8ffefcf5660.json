{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withCtx as _withCtx, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-67b2d2e4\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  class: \"record-info\"\n};\nconst _hoisted_3 = {\n  class: \"date\"\n};\nconst _hoisted_4 = {\n  class: \"status\"\n};\nconst _hoisted_5 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_van_nav_bar = _resolveComponent(\"van-nav-bar\");\n  const _component_van_search = _resolveComponent(\"van-search\");\n  const _component_record_card = _resolveComponent(\"record-card\");\n  const _component_van_field = _resolveComponent(\"van-field\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"section\", null, [_createVNode(_component_van_nav_bar, {\n    title: \"标题\",\n    \"left-text\": \"返回\",\n    \"left-arrow\": \"\",\n    onClickLeft: $setup.goBack\n  }), _createVNode(_component_van_search, {\n    modelValue: _ctx.searchKeyword,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.searchKeyword = $event),\n    placeholder: \"请输入搜索关键词\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])]), $setup.records.length ? (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.records, info => {\n    return _openBlock(), _createElementBlock(\"section\", {\n      key: info\n    }, [_createVNode(_component_record_card, {\n      onClick: $event => $setup.showDetail(info.id)\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"p\", _hoisted_3, _toDisplayString(info.consultationDate), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_4, _toDisplayString(info.status === 1 ? '已完成' : '未完成'), 1 /* TEXT */)])]),\n\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), $setup.show[info.id] === 1 ? (_openBlock(), _createElementBlock(\"section\", _hoisted_5, [$setup.peerStore.role === 1 ? (_openBlock(), _createBlock(_component_van_field, {\n      key: 0,\n      modelValue: info.otherName,\n      \"onUpdate:modelValue\": $event => info.otherName = $event,\n      label: \"医生姓名\",\n      placeholder: \"请输入医生姓名\",\n      readonly: \"\"\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"])) : _createCommentVNode(\"v-if\", true), $setup.peerStore.role === 2 ? (_openBlock(), _createBlock(_component_van_field, {\n      key: 1,\n      modelValue: info.otherName,\n      \"onUpdate:modelValue\": $event => info.otherName = $event,\n      label: \"患者姓名\",\n      placeholder: \"请输入患者姓名\",\n      readonly: \"\"\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_van_field, {\n      modelValue: info.diagnosis,\n      \"onUpdate:modelValue\": $event => info.diagnosis = $event,\n      label: \"诊断结果\",\n      placeholder: \"请输入诊断结果\"\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"]), _createVNode(_component_van_field, {\n      modelValue: info.prescription,\n      \"onUpdate:modelValue\": $event => info.prescription = $event,\n      label: \"处方\",\n      placeholder: \"请输入处方\"\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"]), _createCommentVNode(\"        <van-field v-model=\\\"info.videoUrl\\\" label=\\\"问诊回放\\\" placeholder=\\\"请输入问诊回放链接\\\" readonly/>\"), _createVNode(_component_el_button, {\n      onClick: _cache[1] || (_cache[1] = $event => $setup.goInfo())\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"详情\")]),\n      _: 1 /* STABLE */\n    }), $setup.peerStore.role === 2 ? (_openBlock(), _createBlock(_component_el_button, {\n      key: 2,\n      type: \"primary\",\n      onClick: $event => $setup.updateRecord(info)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"提交\")]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","_createVNode","_component_van_nav_bar","title","onClickLeft","$setup","goBack","_component_van_search","_ctx","searchKeyword","$event","placeholder","records","length","_createElementBlock","_hoisted_1","_Fragment","_renderList","info","key","_component_record_card","onClick","showDetail","id","_hoisted_2","_hoisted_3","_toDisplayString","consultationDate","_hoisted_4","status","show","_hoisted_5","peerStore","role","_createBlock","_component_van_field","otherName","label","readonly","diagnosis","prescription","_createCommentVNode","_component_el_button","_cache","goInfo","type","updateRecord"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/zj/Front/src/views/RecordListView.vue"],"sourcesContent":["<template>\n  <section>\n    <van-nav-bar\n        title=\"标题\"\n        left-text=\"返回\"\n        left-arrow\n        @click-left=\"goBack\"\n    />\n    <van-search v-model=\"searchKeyword\" placeholder=\"请输入搜索关键词\" />\n  </section>\n  <section v-if=\"records.length\">\n    <section v-for=\"info of records\" :key=\"info\">\n      <record-card @click=\"showDetail(info.id)\">\n        <div class=\"record-info\">\n          <p class=\"date\">{{ info.consultationDate }}</p>\n          <p class=\"status\">{{ info.status === 1 ? '已完成' : '未完成' }}</p>\n        </div>\n      </record-card>\n      <section v-if=\"show[info.id] === 1\">\n        <van-field v-if=\"peerStore.role === 1\" v-model=\"info.otherName\" label=\"医生姓名\" placeholder=\"请输入医生姓名\" readonly />\n        <van-field v-if=\"peerStore.role === 2\" v-model=\"info.otherName\" label=\"患者姓名\" placeholder=\"请输入患者姓名\" readonly />\n        <van-field v-model=\"info.diagnosis\" label=\"诊断结果\" placeholder=\"请输入诊断结果\" />\n        <van-field v-model=\"info.prescription\" label=\"处方\" placeholder=\"请输入处方\" />\n<!--        <van-field v-model=\"info.videoUrl\" label=\"问诊回放\" placeholder=\"请输入问诊回放链接\" readonly/>-->\n\n        <el-button @click=\"goInfo()\">详情</el-button>\n        <el-button v-if=\"peerStore.role === 2\" type=\"primary\" @click=\"updateRecord(info)\" >提交</el-button>\n      </section>\n    </section>\n  </section>\n</template>\n\n\n<script setup>\nimport $ from \"jquery\";\nimport {apiUrl} from \"../../config\";\nimport {showToast} from \"vant\";\nimport usePeerStore from \"@/store/peer\";\nimport {ref} from \"vue\";\nimport router from \"@/router\";\n\nlet peerStore = usePeerStore();\nconst records = ref([]); // 创建响应式的userInfos\ngetRecords()\nconst show = ref({});\n\nfunction goBack(){\n  router.go(-1);\n}\nfunction goInfo(){\n  router.push({path: '/saveRecord'});\n}\nfunction showDetail(id) {\n  show.value[id] = show.value[id] === 1 ? 0 : 1;\n}\n\nfunction updateRecord(info) {\n  $.ajax({\n    url: `${apiUrl}/api/record/updateRecord/`,\n    type: \"post\",\n    data: {\n      id: info.id,\n      diagnosis: info.diagnosis,\n      prescription: info.prescription,\n      videoUrl: info.videoUrl,\n    },\n    headers: {\n      Authorization: \"Bearer \" + peerStore.token,\n    },\n    success(resp) {\n      if (resp.code === 200) {\n        showToast(\"更新成功\");\n        getRecords();\n      } else {\n        showToast(resp.message);\n      }\n    },\n  });\n}\nfunction getRecords() {\n  let peerStore = usePeerStore();\n  $.ajax({\n    url: `${apiUrl}/api/record/getRecords/`,\n    type: \"post\",\n    headers: {\n      Authorization: \"Bearer \" + peerStore.token,\n    },\n    success(resp) {\n      if (resp.code === 200) {\n        records.value = resp.data; // 更新userInfos的值\n      } else {\n        showToast(resp.message);\n      }\n    },\n  });\n}\n</script>\n\n<style scoped lang=\"scss\">\n.wide-button {\n  width: 200px; /* 根据需要调整按钮宽度 */\n  position: fixed;\n  left: 50%;\n  bottom: 80px; /* 调整底部距离根据需要 */\n  transform: translateX(-50%);\n}\n\n.center-bottom {\n  display: flex;\n  justify-content: center;\n}\n\n.record-info {\n  display: flex;\n  justify-content: space-between;\n}\n\n.record-info .date {\n  text-align: left;\n  padding-right: 10px; /* 可根据实际情况调整间距 */\n}\n\n.record-info .status {\n  text-align: right;\n}\n\n/* 样式可以根据自己的需求进行调整 */\n.record-info {\n  display: flex;\n  justify-content: space-between;\n}\n.date {\n  font-weight: bold;\n}\n.status {\n  color: #999;\n}\n.right-aligned {\n  width: 120px;\n  display: block;\n  margin: 0 auto;\n}\n\n</style>"],"mappings":";;;;;;EAaaA,KAAK,EAAC;AAAa;;EACnBA,KAAK,EAAC;AAAM;;EACZA,KAAK,EAAC;AAAQ;;;;;;;;;;6DAdzBC,mBAAA,CAQU,kBAPRC,YAAA,CAKEC,sBAAA;IAJEC,KAAK,EAAC,IAAI;IACV,WAAS,EAAC,IAAI;IACd,YAAU,EAAV,EAAU;IACTC,WAAU,EAAEC,MAAA,CAAAC;MAEjBL,YAAA,CAA6DM,qBAAA;gBAAxCC,IAAA,CAAAC,aAAa;+DAAbD,IAAA,CAAAC,aAAa,GAAAC,MAAA;IAAEC,WAAW,EAAC;6CAEnCN,MAAA,CAAAO,OAAO,CAACC,MAAM,I,cAA7BC,mBAAA,CAmBU,WAAAC,UAAA,I,kBAlBRD,mBAAA,CAiBUE,SAAA,QAAAC,WAAA,CAjBcZ,MAAA,CAAAO,OAAO,EAAfM,IAAI;yBAApBJ,mBAAA,CAiBU;MAjBwBK,GAAG,EAAED;IAAI,IACzCjB,YAAA,CAKcmB,sBAAA;MALAC,OAAK,EAAAX,MAAA,IAAEL,MAAA,CAAAiB,UAAU,CAACJ,IAAI,CAACK,EAAE;;wBACrC,MAGM,CAHNvB,mBAAA,CAGM,OAHNwB,UAGM,GAFJxB,mBAAA,CAA+C,KAA/CyB,UAA+C,EAAAC,gBAAA,CAA5BR,IAAI,CAACS,gBAAgB,kBACxC3B,mBAAA,CAA6D,KAA7D4B,UAA6D,EAAAF,gBAAA,CAAxCR,IAAI,CAACW,MAAM,uC;;;sDAGrBxB,MAAA,CAAAyB,IAAI,CAACZ,IAAI,CAACK,EAAE,W,cAA3BT,mBAAA,CASU,WAAAiB,UAAA,GARS1B,MAAA,CAAA2B,SAAS,CAACC,IAAI,U,cAA/BC,YAAA,CAA8GC,oBAAA;;kBAA9DjB,IAAI,CAACkB,SAAS;uCAAdlB,IAAI,CAACkB,SAAS,GAAA1B,MAAA;MAAE2B,KAAK,EAAC,MAAM;MAAC1B,WAAW,EAAC,SAAS;MAAC2B,QAAQ,EAAR;yGAClFjC,MAAA,CAAA2B,SAAS,CAACC,IAAI,U,cAA/BC,YAAA,CAA8GC,oBAAA;;kBAA9DjB,IAAI,CAACkB,SAAS;uCAAdlB,IAAI,CAACkB,SAAS,GAAA1B,MAAA;MAAE2B,KAAK,EAAC,MAAM;MAAC1B,WAAW,EAAC,SAAS;MAAC2B,QAAQ,EAAR;yGACnGrC,YAAA,CAAyEkC,oBAAA;kBAArDjB,IAAI,CAACqB,SAAS;uCAAdrB,IAAI,CAACqB,SAAS,GAAA7B,MAAA;MAAE2B,KAAK,EAAC,MAAM;MAAC1B,WAAW,EAAC;oEAC7DV,YAAA,CAAwEkC,oBAAA;kBAApDjB,IAAI,CAACsB,YAAY;uCAAjBtB,IAAI,CAACsB,YAAY,GAAA9B,MAAA;MAAE2B,KAAK,EAAC,IAAI;MAAC1B,WAAW,EAAC;oEACtE8B,mBAAA,oGAAiG,EAEzFxC,YAAA,CAA2CyC,oBAAA;MAA/BrB,OAAK,EAAAsB,MAAA,QAAAA,MAAA,MAAAjC,MAAA,IAAEL,MAAA,CAAAuC,MAAM;;wBAAI,MAAE,C,iBAAF,IAAE,E;;QACdvC,MAAA,CAAA2B,SAAS,CAACC,IAAI,U,cAA/BC,YAAA,CAAiGQ,oBAAA;;MAA1DG,IAAI,EAAC,SAAS;MAAExB,OAAK,EAAAX,MAAA,IAAEL,MAAA,CAAAyC,YAAY,CAAC5B,IAAI;;wBAAI,MAAE,C,iBAAF,IAAE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}