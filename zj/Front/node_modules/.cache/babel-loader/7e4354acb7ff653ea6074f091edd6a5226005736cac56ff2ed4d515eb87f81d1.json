{"ast":null,"code":"var _, documentTemplate, fs, utils;\nfs = require('fs');\ndocumentTemplate = require('./templates/document');\nutils = require('./utils');\n_ = {\n  merge: require('lodash.merge')\n};\nmodule.exports = {\n  generateDocument: function (zip) {\n    var buffer;\n    buffer = zip.generate({\n      type: 'arraybuffer'\n    });\n    if (global.Blob) {\n      return new Blob([buffer], {\n        type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n      });\n    } else if (global.Buffer) {\n      return new Buffer(new Uint8Array(buffer));\n    } else {\n      throw new Error(\"Neither Blob nor Buffer are accessible in this environment. \" + \"Consider adding Blob.js shim\");\n    }\n  },\n  renderDocumentFile: function (documentOptions) {\n    var templateData;\n    if (documentOptions == null) {\n      documentOptions = {};\n    }\n    templateData = _.merge({\n      margins: {\n        top: 1440,\n        right: 1440,\n        bottom: 1440,\n        left: 1440,\n        header: 720,\n        footer: 720,\n        gutter: 0\n      }\n    }, function () {\n      switch (documentOptions.orientation) {\n        case 'landscape':\n          return {\n            height: 12240,\n            width: 15840,\n            orient: 'landscape'\n          };\n        default:\n          return {\n            width: 12240,\n            height: 15840,\n            orient: 'portrait'\n          };\n      }\n    }(), {\n      margins: documentOptions.margins\n    });\n    return documentTemplate(templateData);\n  },\n  addFiles: function (zip, htmlSource, documentOptions) {\n    zip.file('[Content_Types].xml', fs.readFileSync(__dirname + '/assets/content_types.xml'));\n    zip.folder('_rels').file('.rels', fs.readFileSync(__dirname + '/assets/rels.xml'));\n    return zip.folder('word').file('document.xml', this.renderDocumentFile(documentOptions)).file('afchunk.mht', utils.getMHTdocument(htmlSource)).folder('_rels').file('document.xml.rels', fs.readFileSync(__dirname + '/assets/document.xml.rels'));\n  }\n};","map":{"version":3,"names":["_","documentTemplate","fs","utils","require","merge","module","exports","generateDocument","zip","buffer","generate","type","global","Blob","Buffer","Uint8Array","Error","renderDocumentFile","documentOptions","templateData","margins","top","right","bottom","left","header","footer","gutter","orientation","height","width","orient","addFiles","htmlSource","file","readFileSync","__dirname","folder","getMHTdocument"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/zj/Front/node_modules/html-docx-js/build/internal.js"],"sourcesContent":["var _, documentTemplate, fs, utils;\n\nfs = require('fs');\n\ndocumentTemplate = require('./templates/document');\n\nutils = require('./utils');\n\n_ = {\n  merge: require('lodash.merge')\n};\n\nmodule.exports = {\n  generateDocument: function(zip) {\n    var buffer;\n    buffer = zip.generate({\n      type: 'arraybuffer'\n    });\n    if (global.Blob) {\n      return new Blob([buffer], {\n        type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n      });\n    } else if (global.Buffer) {\n      return new Buffer(new Uint8Array(buffer));\n    } else {\n      throw new Error(\"Neither Blob nor Buffer are accessible in this environment. \" + \"Consider adding Blob.js shim\");\n    }\n  },\n  renderDocumentFile: function(documentOptions) {\n    var templateData;\n    if (documentOptions == null) {\n      documentOptions = {};\n    }\n    templateData = _.merge({\n      margins: {\n        top: 1440,\n        right: 1440,\n        bottom: 1440,\n        left: 1440,\n        header: 720,\n        footer: 720,\n        gutter: 0\n      }\n    }, (function() {\n      switch (documentOptions.orientation) {\n        case 'landscape':\n          return {\n            height: 12240,\n            width: 15840,\n            orient: 'landscape'\n          };\n        default:\n          return {\n            width: 12240,\n            height: 15840,\n            orient: 'portrait'\n          };\n      }\n    })(), {\n      margins: documentOptions.margins\n    });\n    return documentTemplate(templateData);\n  },\n  addFiles: function(zip, htmlSource, documentOptions) {\n    zip.file('[Content_Types].xml', fs.readFileSync(__dirname + '/assets/content_types.xml'));\n    zip.folder('_rels').file('.rels', fs.readFileSync(__dirname + '/assets/rels.xml'));\n    return zip.folder('word').file('document.xml', this.renderDocumentFile(documentOptions)).file('afchunk.mht', utils.getMHTdocument(htmlSource)).folder('_rels').file('document.xml.rels', fs.readFileSync(__dirname + '/assets/document.xml.rels'));\n  }\n};\n"],"mappings":"AAAA,IAAIA,CAAC,EAAEC,gBAAgB,EAAEC,EAAE,EAAEC,KAAK;AAElCD,EAAE,GAAGE,OAAO,CAAC,IAAI,CAAC;AAElBH,gBAAgB,GAAGG,OAAO,CAAC,sBAAsB,CAAC;AAElDD,KAAK,GAAGC,OAAO,CAAC,SAAS,CAAC;AAE1BJ,CAAC,GAAG;EACFK,KAAK,EAAED,OAAO,CAAC,cAAc;AAC/B,CAAC;AAEDE,MAAM,CAACC,OAAO,GAAG;EACfC,gBAAgB,EAAE,SAAAA,CAASC,GAAG,EAAE;IAC9B,IAAIC,MAAM;IACVA,MAAM,GAAGD,GAAG,CAACE,QAAQ,CAAC;MACpBC,IAAI,EAAE;IACR,CAAC,CAAC;IACF,IAAIC,MAAM,CAACC,IAAI,EAAE;MACf,OAAO,IAAIA,IAAI,CAAC,CAACJ,MAAM,CAAC,EAAE;QACxBE,IAAI,EAAE;MACR,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIC,MAAM,CAACE,MAAM,EAAE;MACxB,OAAO,IAAIA,MAAM,CAAC,IAAIC,UAAU,CAACN,MAAM,CAAC,CAAC;IAC3C,CAAC,MAAM;MACL,MAAM,IAAIO,KAAK,CAAC,8DAA8D,GAAG,8BAA8B,CAAC;IAClH;EACF,CAAC;EACDC,kBAAkB,EAAE,SAAAA,CAASC,eAAe,EAAE;IAC5C,IAAIC,YAAY;IAChB,IAAID,eAAe,IAAI,IAAI,EAAE;MAC3BA,eAAe,GAAG,CAAC,CAAC;IACtB;IACAC,YAAY,GAAGpB,CAAC,CAACK,KAAK,CAAC;MACrBgB,OAAO,EAAE;QACPC,GAAG,EAAE,IAAI;QACTC,KAAK,EAAE,IAAI;QACXC,MAAM,EAAE,IAAI;QACZC,IAAI,EAAE,IAAI;QACVC,MAAM,EAAE,GAAG;QACXC,MAAM,EAAE,GAAG;QACXC,MAAM,EAAE;MACV;IACF,CAAC,EAAG,YAAW;MACb,QAAQT,eAAe,CAACU,WAAW;QACjC,KAAK,WAAW;UACd,OAAO;YACLC,MAAM,EAAE,KAAK;YACbC,KAAK,EAAE,KAAK;YACZC,MAAM,EAAE;UACV,CAAC;QACH;UACE,OAAO;YACLD,KAAK,EAAE,KAAK;YACZD,MAAM,EAAE,KAAK;YACbE,MAAM,EAAE;UACV,CAAC;MACL;IACF,CAAC,CAAE,CAAC,EAAE;MACJX,OAAO,EAAEF,eAAe,CAACE;IAC3B,CAAC,CAAC;IACF,OAAOpB,gBAAgB,CAACmB,YAAY,CAAC;EACvC,CAAC;EACDa,QAAQ,EAAE,SAAAA,CAASxB,GAAG,EAAEyB,UAAU,EAAEf,eAAe,EAAE;IACnDV,GAAG,CAAC0B,IAAI,CAAC,qBAAqB,EAAEjC,EAAE,CAACkC,YAAY,CAACC,SAAS,GAAG,2BAA2B,CAAC,CAAC;IACzF5B,GAAG,CAAC6B,MAAM,CAAC,OAAO,CAAC,CAACH,IAAI,CAAC,OAAO,EAAEjC,EAAE,CAACkC,YAAY,CAACC,SAAS,GAAG,kBAAkB,CAAC,CAAC;IAClF,OAAO5B,GAAG,CAAC6B,MAAM,CAAC,MAAM,CAAC,CAACH,IAAI,CAAC,cAAc,EAAE,IAAI,CAACjB,kBAAkB,CAACC,eAAe,CAAC,CAAC,CAACgB,IAAI,CAAC,aAAa,EAAEhC,KAAK,CAACoC,cAAc,CAACL,UAAU,CAAC,CAAC,CAACI,MAAM,CAAC,OAAO,CAAC,CAACH,IAAI,CAAC,mBAAmB,EAAEjC,EAAE,CAACkC,YAAY,CAACC,SAAS,GAAG,2BAA2B,CAAC,CAAC;EACpP;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}