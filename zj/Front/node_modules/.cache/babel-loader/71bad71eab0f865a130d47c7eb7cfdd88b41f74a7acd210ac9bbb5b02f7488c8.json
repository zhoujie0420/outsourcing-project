{"ast":null,"code":"import $ from \"jquery\";\nimport { apiUrl } from \"../../config\";\nimport { showToast } from \"vant\";\nimport usePeerStore from \"@/store/peer\";\nimport { ref } from \"vue\";\nimport router from \"@/router\";\nexport default {\n  __name: 'RecordListView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let peerStore = usePeerStore();\n    const records = ref([]); // 创建响应式的userInfos\n    getRecords();\n    const show = ref({});\n    function goBack() {\n      router.go(-1);\n    }\n    function goInfo() {\n      router.push({\n        path: '/saveRecord'\n      });\n    }\n    function showDetail(id) {\n      show.value[id] = show.value[id] === 1 ? 0 : 1;\n    }\n    function updateRecord(info) {\n      $.ajax({\n        url: `${apiUrl}/api/record/updateRecord/`,\n        type: \"post\",\n        data: {\n          id: info.id,\n          diagnosis: info.diagnosis,\n          prescription: info.prescription,\n          videoUrl: info.videoUrl\n        },\n        headers: {\n          Authorization: \"Bearer \" + peerStore.token\n        },\n        success(resp) {\n          if (resp.code === 200) {\n            showToast(\"更新成功\");\n            getRecords();\n          } else {\n            showToast(resp.message);\n          }\n        }\n      });\n    }\n    function getRecords() {\n      let peerStore = usePeerStore();\n      $.ajax({\n        url: `${apiUrl}/api/record/getRecords/`,\n        type: \"post\",\n        headers: {\n          Authorization: \"Bearer \" + peerStore.token\n        },\n        success(resp) {\n          if (resp.code === 200) {\n            records.value = resp.data; // 更新userInfos的值\n          } else {\n            showToast(resp.message);\n          }\n        }\n      });\n    }\n    const __returned__ = {\n      get peerStore() {\n        return peerStore;\n      },\n      set peerStore(v) {\n        peerStore = v;\n      },\n      records,\n      show,\n      goBack,\n      goInfo,\n      showDetail,\n      updateRecord,\n      getRecords,\n      get $() {\n        return $;\n      },\n      get apiUrl() {\n        return apiUrl;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get usePeerStore() {\n        return usePeerStore;\n      },\n      ref,\n      get router() {\n        return router;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["$","apiUrl","showToast","usePeerStore","ref","router","peerStore","records","getRecords","show","goBack","go","goInfo","push","path","showDetail","id","value","updateRecord","info","ajax","url","type","data","diagnosis","prescription","videoUrl","headers","Authorization","token","success","resp","code","message"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/zj/Front/src/views/RecordListView.vue"],"sourcesContent":["<template>\n  <section>\n    <van-nav-bar\n        title=\"标题\"\n        left-text=\"返回\"\n        left-arrow\n        @click-left=\"goBack\"\n    />\n    <van-search v-model=\"searchKeyword\" placeholder=\"请输入搜索关键词\" />\n  </section>\n  <section v-if=\"records.length\">\n    <section v-for=\"info of records\" :key=\"info\">\n      <record-card @click=\"showDetail(info.id)\">\n        <div class=\"record-info\">\n          <p class=\"date\">{{ info.consultationDate }}</p>\n          <p class=\"status\">{{ info.status === 1 ? '已完成' : '未完成' }}</p>\n        </div>\n      </record-card>\n      <section v-if=\"show[info.id] === 1\">\n        <van-field v-if=\"peerStore.role === 1\" v-model=\"info.otherName\" label=\"医生姓名\" placeholder=\"请输入医生姓名\" readonly />\n        <van-field v-if=\"peerStore.role === 2\" v-model=\"info.otherName\" label=\"患者姓名\" placeholder=\"请输入患者姓名\" readonly />\n        <van-field v-model=\"info.diagnosis\" label=\"诊断结果\" placeholder=\"请输入诊断结果\" />\n        <van-field v-model=\"info.prescription\" label=\"处方\" placeholder=\"请输入处方\" />\n<!--        <van-field v-model=\"info.videoUrl\" label=\"问诊回放\" placeholder=\"请输入问诊回放链接\" readonly/>-->\n\n        <el-button v-if=\"peerStore.role === 2\" @click=\"goInfo()\">处方详情</el-button>\n        <el-button v-if=\"peerStore.role === 1\" @click=\"goInfo()\">处方下载</el-button>\n        <el-button v-if=\"peerStore.role === 2\" type=\"primary\" @click=\"updateRecord(info)\" >提交</el-button>\n      </section>\n    </section>\n  </section>\n</template>\n\n\n<script setup>\nimport $ from \"jquery\";\nimport {apiUrl} from \"../../config\";\nimport {showToast} from \"vant\";\nimport usePeerStore from \"@/store/peer\";\nimport {ref} from \"vue\";\nimport router from \"@/router\";\n\nlet peerStore = usePeerStore();\nconst records = ref([]); // 创建响应式的userInfos\ngetRecords()\nconst show = ref({});\n\nfunction goBack(){\n  router.go(-1);\n}\nfunction goInfo(){\n  router.push({path: '/saveRecord'});\n}\nfunction showDetail(id) {\n  show.value[id] = show.value[id] === 1 ? 0 : 1;\n}\n\nfunction updateRecord(info) {\n  $.ajax({\n    url: `${apiUrl}/api/record/updateRecord/`,\n    type: \"post\",\n    data: {\n      id: info.id,\n      diagnosis: info.diagnosis,\n      prescription: info.prescription,\n      videoUrl: info.videoUrl,\n    },\n    headers: {\n      Authorization: \"Bearer \" + peerStore.token,\n    },\n    success(resp) {\n      if (resp.code === 200) {\n        showToast(\"更新成功\");\n        getRecords();\n      } else {\n        showToast(resp.message);\n      }\n    },\n  });\n}\nfunction getRecords() {\n  let peerStore = usePeerStore();\n  $.ajax({\n    url: `${apiUrl}/api/record/getRecords/`,\n    type: \"post\",\n    headers: {\n      Authorization: \"Bearer \" + peerStore.token,\n    },\n    success(resp) {\n      if (resp.code === 200) {\n        records.value = resp.data; // 更新userInfos的值\n      } else {\n        showToast(resp.message);\n      }\n    },\n  });\n}\n</script>\n\n<style scoped lang=\"scss\">\n.wide-button {\n  width: 200px; /* 根据需要调整按钮宽度 */\n  position: fixed;\n  left: 50%;\n  bottom: 80px; /* 调整底部距离根据需要 */\n  transform: translateX(-50%);\n}\n\n.center-bottom {\n  display: flex;\n  justify-content: center;\n}\n\n.record-info {\n  display: flex;\n  justify-content: space-between;\n}\n\n.record-info .date {\n  text-align: left;\n  padding-right: 10px; /* 可根据实际情况调整间距 */\n}\n\n.record-info .status {\n  text-align: right;\n}\n\n/* 样式可以根据自己的需求进行调整 */\n.record-info {\n  display: flex;\n  justify-content: space-between;\n}\n.date {\n  font-weight: bold;\n}\n.status {\n  color: #999;\n}\n.right-aligned {\n  width: 120px;\n  display: block;\n  margin: 0 auto;\n}\n\n</style>"],"mappings":"AAmCA,OAAOA,CAAC,MAAM,QAAQ;AACtB,SAAQC,MAAM,QAAO,cAAc;AACnC,SAAQC,SAAS,QAAO,MAAM;AAC9B,OAAOC,YAAY,MAAM,cAAc;AACvC,SAAQC,GAAG,QAAO,KAAK;AACvB,OAAOC,MAAM,MAAM,UAAU;;;;;;;IAE7B,IAAIC,SAAS,GAAGH,YAAY,CAAC,CAAC;IAC9B,MAAMI,OAAO,GAAGH,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACzBI,UAAU,CAAC,CAAC;IACZ,MAAMC,IAAI,GAAGL,GAAG,CAAC,CAAC,CAAC,CAAC;IAEpB,SAASM,MAAMA,CAAA,EAAE;MACfL,MAAM,CAACM,EAAE,CAAC,CAAC,CAAC,CAAC;IACf;IACA,SAASC,MAAMA,CAAA,EAAE;MACfP,MAAM,CAACQ,IAAI,CAAC;QAACC,IAAI,EAAE;MAAa,CAAC,CAAC;IACpC;IACA,SAASC,UAAUA,CAACC,EAAE,EAAE;MACtBP,IAAI,CAACQ,KAAK,CAACD,EAAE,CAAC,GAAGP,IAAI,CAACQ,KAAK,CAACD,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;IAC/C;IAEA,SAASE,YAAYA,CAACC,IAAI,EAAE;MAC1BnB,CAAC,CAACoB,IAAI,CAAC;QACLC,GAAG,EAAG,GAAEpB,MAAO,2BAA0B;QACzCqB,IAAI,EAAE,MAAM;QACZC,IAAI,EAAE;UACJP,EAAE,EAAEG,IAAI,CAACH,EAAE;UACXQ,SAAS,EAAEL,IAAI,CAACK,SAAS;UACzBC,YAAY,EAAEN,IAAI,CAACM,YAAY;UAC/BC,QAAQ,EAAEP,IAAI,CAACO;QACjB,CAAC;QACDC,OAAO,EAAE;UACPC,aAAa,EAAE,SAAS,GAAGtB,SAAS,CAACuB;QACvC,CAAC;QACDC,OAAOA,CAACC,IAAI,EAAE;UACZ,IAAIA,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;YACrB9B,SAAS,CAAC,MAAM,CAAC;YACjBM,UAAU,CAAC,CAAC;UACd,CAAC,MAAM;YACLN,SAAS,CAAC6B,IAAI,CAACE,OAAO,CAAC;UACzB;QACF;MACF,CAAC,CAAC;IACJ;IACA,SAASzB,UAAUA,CAAA,EAAG;MACpB,IAAIF,SAAS,GAAGH,YAAY,CAAC,CAAC;MAC9BH,CAAC,CAACoB,IAAI,CAAC;QACLC,GAAG,EAAG,GAAEpB,MAAO,yBAAwB;QACvCqB,IAAI,EAAE,MAAM;QACZK,OAAO,EAAE;UACPC,aAAa,EAAE,SAAS,GAAGtB,SAAS,CAACuB;QACvC,CAAC;QACDC,OAAOA,CAACC,IAAI,EAAE;UACZ,IAAIA,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;YACrBzB,OAAO,CAACU,KAAK,GAAGc,IAAI,CAACR,IAAI,CAAC,CAAC;UAC7B,CAAC,MAAM;YACLrB,SAAS,CAAC6B,IAAI,CAACE,OAAO,CAAC;UACzB;QACF;MACF,CAAC,CAAC;IACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}