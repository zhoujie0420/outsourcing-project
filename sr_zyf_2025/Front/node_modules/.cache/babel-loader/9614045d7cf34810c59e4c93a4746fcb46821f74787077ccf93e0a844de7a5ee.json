{"ast":null,"code":"import useFriendStore from \"@/store/friend\";\nimport usePeerStore from \"@/store/peer\";\nimport FriendCard from \"@/components/FriendCard.vue\";\nimport { useRouter } from \"vue-router\";\nimport { showToast } from \"vant\";\nimport { apiUrl } from \"../../config\";\nimport $ from \"jquery\";\nimport { ref } from \"vue\";\nexport default {\n  __name: 'FriendsListView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let friendStore = useFriendStore();\n    const peerStore = usePeerStore();\n    let router = useRouter();\n    getRole();\n    let userInfos = ref([]); // 创建响应式的userInfos\n    function jumpToVideoCallCallingView(calleePeerId) {\n      console.log(\"peerStore.localPeer\" + peerStore.localPeer);\n      if (peerStore.localPeer && peerStore.localPeer.open) {\n        if (peerStore.dataConnection) {\n          showToast(\"currently busy\");\n        } else {\n          router.push({\n            path: \"/video-call-calling-view\",\n            query: {\n              calleePeerId\n            }\n          });\n        }\n      } else {\n        console.log(\"calleePeerId\" + calleePeerId);\n        showToast(\"local peer not opened\");\n      }\n    }\n    function getRole() {\n      $.ajax({\n        url: `${apiUrl}/api/user/account/getRole/`,\n        type: \"post\",\n        data: {\n          userList: friendStore.onlineList,\n          userRole: peerStore.role\n        },\n        headers: {\n          Authorization: \"Bearer \" + peerStore.token\n        },\n        success(resp) {\n          if (resp.code === 200) {\n            userInfos.value = resp.data; // 更新userInfos的值\n          } else {\n            showToast(resp.message);\n          }\n        }\n      });\n    }\n    const __returned__ = {\n      get friendStore() {\n        return friendStore;\n      },\n      set friendStore(v) {\n        friendStore = v;\n      },\n      peerStore,\n      get router() {\n        return router;\n      },\n      set router(v) {\n        router = v;\n      },\n      get userInfos() {\n        return userInfos;\n      },\n      set userInfos(v) {\n        userInfos = v;\n      },\n      jumpToVideoCallCallingView,\n      getRole,\n      get useFriendStore() {\n        return useFriendStore;\n      },\n      get usePeerStore() {\n        return usePeerStore;\n      },\n      FriendCard,\n      get useRouter() {\n        return useRouter;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get apiUrl() {\n        return apiUrl;\n      },\n      get $() {\n        return $;\n      },\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useFriendStore","usePeerStore","FriendCard","useRouter","showToast","apiUrl","$","ref","friendStore","peerStore","router","getRole","userInfos","jumpToVideoCallCallingView","calleePeerId","console","log","localPeer","open","dataConnection","push","path","query","ajax","url","type","data","userList","onlineList","userRole","role","headers","Authorization","token","success","resp","code","value","message"],"sources":["/Users/jiezhou/IdeaProjects/graduaction/sr_RemoteDoctor_2025/Front/src/views/FriendsListView.vue"],"sourcesContent":["<template>\n  <section>\n    <van-nav-bar title=\"视频问诊\" fixed placeholder safe-area-inset-top/>\n  </section>\n  <section>\n    <van-search placeholder=\"请输入搜索关键词\"/>\n  </section>\n  <section v-if=\"userInfos.length\">\n    <van-divider>轻触即可视频问诊</van-divider>\n    <section v-for=\"info of userInfos\" :key=\"info\">\n      <friend-card @click=\"jumpToVideoCallCallingView(info.id)\">\n        {{ info.username }} / {{ info.departmentName || \"患者\" }}\n      </friend-card>\n    </section>\n  </section>\n</template>\n\n<script setup>\nimport useFriendStore from \"@/store/friend\";\nimport usePeerStore from \"@/store/peer\";\nimport FriendCard from \"@/components/FriendCard.vue\";\nimport {useRouter} from \"vue-router\";\nimport {showToast} from \"vant\";\nimport {apiUrl} from \"../../config\";\nimport $ from \"jquery\";\nimport {ref} from \"vue\";\n\nlet friendStore = useFriendStore();\nconst peerStore = usePeerStore();\nlet router = useRouter();\ngetRole();\nlet userInfos = ref([]); // 创建响应式的userInfos\nfunction jumpToVideoCallCallingView(calleePeerId) {\n  console.log(\"peerStore.localPeer\" + peerStore.localPeer);\n  if (peerStore.localPeer && peerStore.localPeer.open) {\n    if (peerStore.dataConnection) {\n      showToast(\"currently busy\");\n    } else {\n      router.push({\n        path: \"/video-call-calling-view\",\n        query: {\n          calleePeerId\n        }\n      });\n    }\n  } else {\n    console.log(\"calleePeerId\" + calleePeerId);\n    showToast(\"local peer not opened\");\n  }\n}\n\nfunction getRole() {\n  $.ajax({\n    url: `${apiUrl}/api/user/account/getRole/`,\n    type: \"post\",\n    data: {\n      userList: friendStore.onlineList,\n      userRole: peerStore.role,\n    },\n    headers: {\n      Authorization: \"Bearer \" + peerStore.token,\n    },\n    success(resp) {\n      if (resp.code === 200) {\n        userInfos.value = resp.data; // 更新userInfos的值\n      } else {\n        showToast(resp.message);\n      }\n    },\n  });\n}\n\n\n</script>"],"mappings":"AAkBA,OAAOA,cAAc,MAAM,gBAAgB;AAC3C,OAAOC,YAAY,MAAM,cAAc;AACvC,OAAOC,UAAU,MAAM,6BAA6B;AACpD,SAAQC,SAAS,QAAO,YAAY;AACpC,SAAQC,SAAS,QAAO,MAAM;AAC9B,SAAQC,MAAM,QAAO,cAAc;AACnC,OAAOC,CAAC,MAAM,QAAQ;AACtB,SAAQC,GAAG,QAAO,KAAK;;;;;;;IAEvB,IAAIC,WAAW,GAAGR,cAAc,CAAC,CAAC;IAClC,MAAMS,SAAS,GAAGR,YAAY,CAAC,CAAC;IAChC,IAAIS,MAAM,GAAGP,SAAS,CAAC,CAAC;IACxBQ,OAAO,CAAC,CAAC;IACT,IAAIC,SAAS,GAAGL,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACzB,SAASM,0BAA0BA,CAACC,YAAY,EAAE;MAChDC,OAAO,CAACC,GAAG,CAAC,qBAAqB,GAAGP,SAAS,CAACQ,SAAS,CAAC;MACxD,IAAIR,SAAS,CAACQ,SAAS,IAAIR,SAAS,CAACQ,SAAS,CAACC,IAAI,EAAE;QACnD,IAAIT,SAAS,CAACU,cAAc,EAAE;UAC5Bf,SAAS,CAAC,gBAAgB,CAAC;QAC7B,CAAC,MAAM;UACLM,MAAM,CAACU,IAAI,CAAC;YACVC,IAAI,EAAE,0BAA0B;YAChCC,KAAK,EAAE;cACLR;YACF;UACF,CAAC,CAAC;QACJ;MACF,CAAC,MAAM;QACLC,OAAO,CAACC,GAAG,CAAC,cAAc,GAAGF,YAAY,CAAC;QAC1CV,SAAS,CAAC,uBAAuB,CAAC;MACpC;IACF;IAEA,SAASO,OAAOA,CAAA,EAAG;MACjBL,CAAC,CAACiB,IAAI,CAAC;QACLC,GAAG,EAAG,GAAEnB,MAAO,4BAA2B;QAC1CoB,IAAI,EAAE,MAAM;QACZC,IAAI,EAAE;UACJC,QAAQ,EAAEnB,WAAW,CAACoB,UAAU;UAChCC,QAAQ,EAAEpB,SAAS,CAACqB;QACtB,CAAC;QACDC,OAAO,EAAE;UACPC,aAAa,EAAE,SAAS,GAAGvB,SAAS,CAACwB;QACvC,CAAC;QACDC,OAAOA,CAACC,IAAI,EAAE;UACZ,IAAIA,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;YACrBxB,SAAS,CAACyB,KAAK,GAAGF,IAAI,CAACT,IAAI,CAAC,CAAC;UAC/B,CAAC,MAAM;YACLtB,SAAS,CAAC+B,IAAI,CAACG,OAAO,CAAC;UACzB;QACF;MACF,CAAC,CAAC;IACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}